<p style="margin-bottom: 0cm; line-height: 100%;">Časovač jest to obvod pro nezávisle řízení třech výstupu podle dáne hodiny zapnuti a vypnuti.</p>
<p style="margin-bottom: 0cm; line-height: 100%;">Elektricky obvod jest postaven na mcu pic16f1513 a komunikuje přes i2c s obvodem reálného času, lcd jest napojené přímo na mcu, viz schemat dole.</p>
<p style="margin-bottom: 0cm; line-height: 100%;">main schematic :</p>
<p style="margin-bottom: 0cm; line-height: 100%;"><img src="projekty/Mario/Časovač/main.jpeg" alt="" width="519" height="389" /></p>
<p style="margin-bottom: 0cm; line-height: 100%;">button board and relay switch :</p>
<p style="margin-bottom: 0cm; line-height: 100%;"><img src="projekty/Mario/Časovač/button.jpg" alt="" width="383" height="383" /> <img src="projekty/Mario/Časovač/relay-switch.jpeg" alt="" width="493" height="493" /></p>
<p style="margin-bottom: 0cm; line-height: 100%;"> </p>
<p style="margin-bottom: 0cm; line-height: 100%;">Program jest napsán v ‚C‘ v prostředí MPLAB X IDE od Microchip.</p>
<p style="margin-bottom: 0cm; line-height: 100%;">Cely projekt jest v souboru LCD.zip zde uvádím jen to hlavni.</p>
<p style="margin-bottom: 0cm; line-height: 100%;">Program ještě potřebuje menší úpravu pro výpočet hodiny, v programu kontrola jest rozdělena na hodiny a minuty, úprava polehá na změně hodin na minuty a zjednodušení kontroly času.</p>
<p style="margin-bottom: 0cm; line-height: 100%;">main.c :</p>
<p><code>/*<br /> * File:   main.c<br /> * Author: Mario<br /> *<br /> * Created on February 9, 2017, 3:23 AM<br /> */</code></p>
<p><code>#include <br />#include "mcc_generated_files/mcc.h"<br />#include "mcc_generated_files/pin_manager.h"<br />#include "lcd.h"<br />#include "io.h"         // button definition<br />#include "timer.h"</code></p>
<p><code><br />int main(void)<br />{<br />    SYSTEM_Initialize();<br />    <br />    // Initialize display<br />    Initialization();<br />    Start_LCD();<br />    <br />    OUT_1 = 0;<br />    OUT_2 = 0;<br />    OUT_3 = 0;<br />    <br />    LCD_ON = 1;         // Backlight LCD<br />    eSIG_BUTTON button;<br />    eSIG_TIME showT = T0;<br />        <br />    // Prepare IO timer<br />    IO_Timer_Init(&amp;Time1_ON);<br />    IO_Timer_Init(&amp;Time2_ON);<br />    IO_Timer_Init(&amp;Time3_ON);<br />    IO_Timer_Init(&amp;Time1_OFF);<br />    IO_Timer_Init(&amp;Time2_OFF);<br />    IO_Timer_Init(&amp;Time3_OFF);<br />    <br />    // Timer start<br />    Timer_Init();    <br />    Timer_Set_Time();<br />    <br />    <br />    for(;;){<br />        <br />        <br />        // Read time data and show it<br />        Timer_Read_Time(TIMER_Hours);<br />        Timer_Read_Time(TIMER_Minuts);<br />        Timer_Read_Time(TIMER_Secunds);<br />        ShowTime(showT);<br />        Lcd_Front();<br />        <br />        // Check if time output is the same<br />        TimeControl();<br />        <br />        __delay_ms(100);<br />        button = Input_B();<br />        switch(button)<br />        {<br />            case LEFT:<br />                <br />                button = EMPTY;<br />                break;<br />            case DOWN:<br />                button = EMPTY;<br />                break;<br />            case RIGHT:<br />                Lcd_Menu();<br />                button = EMPTY;<br />                break;<br />            case UP:<br />                button = EMPTY;<br />                break;<br />            case EMPTY:<br />                // Nothing TODO<br />                break;<br />        }<br />    }</code></p>
<p><code>        <br />    return 0;<br />}</code></p>
<p>i2c.c :</p>
<p><code>/* <br /> * File:   lcd.c<br /> * Author: mario<br /> *<br /> * Created on <br /> */</code></p>
<p><code>#include <br />#include "i2c.h"<br />#include "mcc_generated_files/mcc.h"<br />#include</code></p>
<p><code>void I2C_Initialize()<br />{<br />    SSPCON1 = 0x28;<br />    SSPADD = 0x27;              // Bound rate clock generator, 100kH<br />    <br />    <br />}</code></p>
<p><code>void I2C_Write(uint8_t data)<br />{<br />    I2C_Wait();<br />    SSPBUF = data;<br />    I2C_Wait();<br />}</code></p>
<p><code>void I2C_Wait()<br />{<br />    while ((SSPSTAT &amp; 0x04) || (SSPCON2 &amp; 0x1F));<br />    __delay_us(5);<br />}</code></p>
<p><code>void I2C_Stop()<br />{<br />    STOP_BIT = 1;<br />    while(STOP_BIT == 1);<br />}</code></p>
<p>lcd.c :</p>
<p><code>/* <br /> * File:   lcd.c<br /> * Author: mario<br /> *<br /> * Created on 25. ?ervence 2017, 18:09<br /> */</code></p>
<p><code>#include </code></p>
<p><code>#include "mcc_generated_files/mcc.h"<br />#include "lcd.h"<br />#include "timer.h"<br />#include "io.h"</code></p>
<p> </p>
<p><code>void Enab(void)<br />{<br />    Enable = 1;<br />    __delay_us(1);<br />    Enable = 0;<br />    __delay_us(40);<br />    <br />}</code></p>
<p><code>void Clear(void)<br />{<br />    RS = 0;<br />    RW = 0;<br />    LCD_D = 0x01;<br />    Enab();<br />    __delay_ms(1.70); <br />}</code></p>
<p><code>void Initialization(void)<br />{<br />    /*<br />     * Display initialize<br />     */<br />    __delay_ms(50);<br />    RS = 0;<br />    RW = 0;    <br />    LCD_D = 0b00111100;               // Set 8-bit system <br />    Enab();<br />    /*<br />    LCD_D = 0b00011000;         // Cursor and shift<br />    Enab();*/<br />    LCD_D = 0x0E;               // Display ON, cursor ON, brinking ON<br />    Enab();<br />    <br />    LCD_D = 0b00000110;         // Mode set, increment, shifted<br />    Enab();<br />    /*<br />    LCD_D = 0b00000010;         // Cursor at home   <br />    Enab();<br />    __delay_ms(1.70);    <br />    LCD_D = 0b00000001;         // Clear display  <br />    Enab();<br />    __delay_ms(1.70); <br />    */<br />}</code></p>
<p><code>void Write_LCD(uint8_t symbol)<br />{<br />    // Write data<br />    RS = 1;<br />    LCD_D = symbol;   <br />    Enab();<br />    RS = 0;<br />    <br />    // End write<br />}</code></p>
<p><code>void Start_LCD(void)<br />{<br />    //uint8_t i = 0;<br />        <br />    /*LCD_D = 0x08;           // Turn off display and cursor<br />    Enab();<br />    // Write text*/<br />    LCD_D = 0x80;            // Line 1<br />    Enab();<br />    // Pic 16f ver. 1.0<br />    Write_LCD(0x50);<br />    Write_LCD(0x69);<br />    Write_LCD(0x63);<br />    Write_LCD(0x20);<br />    Write_LCD(0x31);<br />    Write_LCD(0x36);<br />    Write_LCD(0x66);<br />    Write_LCD(0x20);<br />    Write_LCD(0x76);<br />    Write_LCD(0x65);<br />    Write_LCD(0x72);<br />    Write_LCD(0x2E);<br />    Write_LCD(0x20);<br />    Write_LCD(0x31);<br />    Write_LCD(0x2E);<br />    Write_LCD(0x30);</code></p>
<p><code>    LCD_D = 0xC0;           // Line 2<br />    Enab();<br />    // Author M.Lubina<br />    Write_LCD(0x41);<br />    Write_LCD(0x75);<br />    Write_LCD(0x74);<br />    Write_LCD(0x68);<br />    Write_LCD(0x6F);<br />    Write_LCD(0x72);<br />    Write_LCD(0x20);<br />    Write_LCD(0x4D);<br />    Write_LCD(0x2E);<br />    Write_LCD(0x4C);<br />    Write_LCD(0x75);<br />    Write_LCD(0x62);<br />    Write_LCD(0x69);<br />    Write_LCD(0x6E);<br />    Write_LCD(0x61);<br />    Write_LCD(0x20);<br />        <br />    /*LCD_D = 0x0C;           // Display ON<br />    Enab();*/<br />    __delay_ms(3000);<br />    LCD_D = 0x01;           // Clear display<br />    Enab();<br />    __delay_ms(1.7);<br />    LCD_D = 0x02;           // Cursor at home<br />    __delay_ms(1.7);<br />}</code></p>
<p><code>uint8_t NumToLcd(uint8_t iNum)<br />{<br />    // Convert number to LCD character<br />    uint8_t iConvert = 0;<br />    <br />    if (iNum &lt;= 9)<br />    {<br />      switch (iNum)<br />      {<br />          case 0:<br />            iConvert = 0x30;<br />            break;<br />          case 1:<br />            iConvert = 0x31;<br />            break;<br />          case 2:<br />            iConvert = 0x32;<br />            break;<br />          case 3:<br />            iConvert = 0x33;<br />            break;<br />          case 4:<br />            iConvert = 0x34;<br />            break;<br />          case 5:<br />            iConvert = 0x35;<br />            break;<br />          case 6:<br />            iConvert = 0x36;<br />            break;<br />          case 7:<br />            iConvert = 0x37;<br />            break;<br />          case 8:<br />            iConvert = 0x38;<br />            break;<br />          case 9:<br />            iConvert = 0x39;<br />            break;<br />          default:<br />              iConvert = 0x30;<br />              break;<br />      }<br />    }<br />    else if (iNum &gt;= 10)<br />    {<br />        iConvert = 0x30;<br />    }<br />    <br />    return iConvert;<br />}</code></p>
<p><code><br />void ShowTime(eSIG_TIME time)<br />{<br />    // Take data from timer and show<br />    // Set position of hours, minutes and secund<br />    <br />    sTime *tmp;<br />    // Control with timer is choice<br />    tmp = SignToTimer(time);<br />    // Show time from the input variable<br />    uint8_t symLcd;<br />    // show separator<br />    <br />    LCD_D = addr_sep1;<br />    Enab();<br />    Write_LCD(separator);<br />    <br />    LCD_D = addr_sep2;<br />    Enab();<br />    Write_LCD(separator);<br />    <br />    // Hours<br />    <br />    // Set hours position<br />    LCD_D = addr_Hours;<br />    Enab();<br />    if (tmp-&gt;sHH == 0)<br />    {<br />        Write_LCD(0x20);            // space symbol<br />        symLcd = NumToLcd(tmp-&gt;sHL);<br />        Write_LCD(symLcd);<br />    }else {<br />        symLcd = NumToLcd(tmp-&gt;sHH);<br />        Write_LCD(symLcd);            // number one<br />        symLcd = NumToLcd(tmp-&gt;sHL);<br />        Write_LCD(symLcd);<br />    }<br />    <br />    // Minutes <br />     <br />    // Set separator<br />    LCD_D = addr_Minuts;                  <br />    Enab();<br />    symLcd = NumToLcd(tmp-&gt;sMH);<br />    Write_LCD(symLcd);            // number one<br />    symLcd = NumToLcd(tmp-&gt;sML);<br />    Write_LCD(symLcd);<br />            <br />    LCD_D = addr_Secund;<br />    Enab();<br />    symLcd = NumToLcd(tmp-&gt;sSH);<br />    Write_LCD(symLcd);            // number one<br />    symLcd = NumToLcd(tmp-&gt;sSL);<br />    Write_LCD(symLcd);<br />          <br />}</code></p>
<p><code>void Lcd_Menu()<br />{<br />    <br />    eSIG_BUTTON ebtn;<br />    int page = 0;<br />    eSIG_TIME setTime = 0;<br />    Clear();</code></p>
<p><code>    <br />    for(;;){<br />         /* Time setting<br />         * Time ON/OFF IO setting<br />         * TEST IO<br />         * <br />         */ <br />        LCD_D = 0x80;            // Line 1<br />        Enab();<br />        Write_LCD(0x20);<br />        Write_LCD(0x20);<br />        Write_LCD(0x20);<br />        Write_LCD(0x20);<br />        Write_LCD(0x20);<br />        Write_LCD(0x4D);        // M<br />        Write_LCD(0x45);        // E<br />        Write_LCD(0x4E);        // N<br />        Write_LCD(0x55);        // U<br />        Write_LCD(0x20);<br />        Write_LCD(0x20);<br />        Write_LCD(0x20);<br />        Write_LCD(0x20);<br />        Write_LCD(0x20);<br />        Write_LCD(0x20);<br />        <br />        Lcd_MenuIN(page, &amp;setTime);<br />        <br />        // Check input<br />        __delay_ms(100);<br />        ebtn = Input_B();<br />        switch(ebtn)<br />        {<br />            case LEFT:<br />                // Clear display and go back to front<br />                Clear();<br />                ebtn = EMPTY;<br />                return;<br />            case DOWN:<br />                ebtn = EMPTY;<br />                page++;<br />                break;<br />            case RIGHT:<br />                // Choice setting<br />                switch(page)<br />                {<br />                    case 0:<br />                        Lcd_Set_Time(setTime);<br />                        Timer_Set_Time();<br />                        break;<br />                    case 1:<br />                        // Set time ON<br />                        Clear();<br />                        LCD_D = 0xC0;           // Line 2<br />                        Enab();<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x43);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x73);<br />                        Write_LCD(0x6F);<br />                        Write_LCD(0x76);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x63);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x31);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x4F);<br />                        Write_LCD(0x4E);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x20);<br />                        Lcd_Set_Time(setTime);<br />                        setTime = T1_OFF;<br />                        Clear();<br />                        LCD_D = 0xC0;           // Line 2<br />                        Enab();<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x43);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x73);<br />                        Write_LCD(0x6F);<br />                        Write_LCD(0x76);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x63);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x31);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x4F);<br />                        Write_LCD(0x46);<br />                        Write_LCD(0x46);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x20);<br />                        Lcd_Set_Time(setTime);<br />                        break;<br />                    case 2:<br />                        Clear();<br />                        LCD_D = 0xC0;           // Line 2<br />                        Enab();<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x43);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x73);<br />                        Write_LCD(0x6F);<br />                        Write_LCD(0x76);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x63);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x32);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x4F);<br />                        Write_LCD(0x4E);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x20);<br />                        Lcd_Set_Time(setTime);<br />                        setTime = T2_OFF;<br />                        Clear();<br />                        LCD_D = 0xC0;           // Line 2<br />                        Enab();<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x43);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x73);<br />                        Write_LCD(0x6F);<br />                        Write_LCD(0x76);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x63);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x32);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x4F);<br />                        Write_LCD(0x46);<br />                        Write_LCD(0x46);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x20);<br />                        Lcd_Set_Time(setTime);<br />                        break;<br />                    case 3:<br />                        Clear();<br />                        LCD_D = 0xC0;           // Line 2<br />                        Enab();<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x43);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x73);<br />                        Write_LCD(0x6F);<br />                        Write_LCD(0x76);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x63);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x33);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x4F);<br />                        Write_LCD(0x4E);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x20);<br />                        Lcd_Set_Time(setTime);<br />                        setTime = T3_OFF;<br />                        Clear();<br />                        LCD_D = 0xC0;           // Line 2<br />                        Enab();<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x43);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x73);<br />                        Write_LCD(0x6F);<br />                        Write_LCD(0x76);<br />                        Write_LCD(0x61);<br />                        Write_LCD(0x63);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x33);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x4F);<br />                        Write_LCD(0x46);<br />                        Write_LCD(0x46);<br />                        Write_LCD(0x20);<br />                        Write_LCD(0x20);<br />                        Lcd_Set_Time(setTime);<br />                        break;<br />                    case 4:<br />                        Test_IO();<br />                        break;<br />                }<br />                ebtn = EMPTY;<br />                break;<br />            case UP:<br />                ebtn = EMPTY;<br />                page--;<br />                break;<br />            case EMPTY:<br />                // Nothing TODO<br />                break;<br />            default:<br />                ebtn = EMPTY;<br />                break;<br />        }<br />        if (page &gt; 4) page = 0;<br />        if (page &lt; 0) page = 4;<br />    }<br />    <br />}</code></p>
<p><code>void Lcd_Front()<br />{<br />    LCD_D = 0xC0;           // Line 2<br />    Enab();<br />    <br />    Write_LCD(0x20);<br />    Write_LCD(0x4F);        // O<br />    Write_LCD(0x31);        // 1<br />    Write_LCD(0x2D);        // - <br />    if (OUT_1 == 1){<br />        Write_LCD(0x48);    // H<br />    }<br />    else Write_LCD(0x4C); // L<br />    Write_LCD(0x20);<br />    Write_LCD(0x4F);        // O<br />    Write_LCD(0x32);        // 2<br />    Write_LCD(0x2D);        // - <br />    if (OUT_2 == 1){<br />        Write_LCD(0x48);    // H<br />    }<br />    else Write_LCD(0x4C); // L<br />    Write_LCD(0x20);<br />    Write_LCD(0x4F);        // O<br />    Write_LCD(0x33);        // 3<br />    Write_LCD(0x2D);        // - <br />    if (OUT_3 == 1){<br />        Write_LCD(0x48);    // H<br />    }<br />    else Write_LCD(0x4C); // L<br />    Write_LCD(0x20);<br />}</code></p>
<p><code>void Lcd_MenuIN(int iMenu, eSIG_TIME *choise)<br />{<br />    // TODO write setting menu in matters on input iMenu<br />    LCD_D = 0xC0;           // Line 2<br />    Enab();<br />    switch (iMenu)<br />    {<br />        case 0:<br />            // System time setting<br />            *choise = T0;<br />            <br />            LCD_D = 0xC0;           // Line 2<br />            Enab();<br />            Write_LCD(0x20);<br />            Write_LCD(0x4E);<br />            Write_LCD(0x61);<br />            Write_LCD(0x73);<br />            Write_LCD(0x74);<br />            Write_LCD(0x61);<br />            Write_LCD(0x76);<br />            Write_LCD(0x20);<br />            Write_LCD(0x68);<br />            Write_LCD(0x6F);<br />            Write_LCD(0x64);<br />            Write_LCD(0x69);<br />            Write_LCD(0x6E);<br />            Write_LCD(0x79);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            break;<br />        case 1:<br />            // Set timer 1<br />            *choise = T1_ON;<br />            <br />            LCD_D = 0xC0;           // Line 2<br />            Enab();<br />            Write_LCD(0x20);<br />            Write_LCD(0x43);<br />            Write_LCD(0x61);<br />            Write_LCD(0x73);<br />            Write_LCD(0x6F);<br />            Write_LCD(0x76);<br />            Write_LCD(0x61);<br />            Write_LCD(0x63);<br />            Write_LCD(0x20);<br />            Write_LCD(0x31);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            break;<br />        case 2:<br />            // Set timer 2<br />            *choise = T2_ON;<br />            <br />            LCD_D = 0xC0;           // Line 2<br />            Enab();<br />            Write_LCD(0x20);<br />            Write_LCD(0x43);<br />            Write_LCD(0x61);<br />            Write_LCD(0x73);<br />            Write_LCD(0x6F);<br />            Write_LCD(0x76);<br />            Write_LCD(0x61);<br />            Write_LCD(0x63);<br />            Write_LCD(0x20);<br />            Write_LCD(0x32);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            break;<br />        case 3:<br />            // Set timer 3<br />            *choise = T3_ON;<br />            <br />            LCD_D = 0xC0;           // Line 2<br />            Enab();<br />            Write_LCD(0x20);<br />            Write_LCD(0x43);<br />            Write_LCD(0x61);<br />            Write_LCD(0x73);<br />            Write_LCD(0x6F);<br />            Write_LCD(0x76);<br />            Write_LCD(0x61);<br />            Write_LCD(0x63);<br />            Write_LCD(0x20);<br />            Write_LCD(0x33);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            break;<br />        case 4:<br />            // Manual output control <br />            LCD_D = 0xC0;           // Line 2<br />            Enab();<br />            Write_LCD(0x20);<br />            Write_LCD(0x54);<br />            Write_LCD(0x65);<br />            Write_LCD(0x73);<br />            Write_LCD(0x74);<br />            Write_LCD(0x20);<br />            Write_LCD(0x76);<br />            Write_LCD(0x79);<br />            Write_LCD(0x73);<br />            Write_LCD(0x74);<br />            Write_LCD(0x75);<br />            Write_LCD(0x70);<br />            Write_LCD(0x75);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            Write_LCD(0x20);<br />            break;  <br />    }</code></p>
<p><code>}</code></p>
<p><code>void Lcd_Set_Time(eSIG_TIME choisetime)<br />{<br />    // Temporary var to set time<br />    sTime *tmp;<br />    <br />    tmp = SignToTimer(choisetime);<br />    <br />    // Use ShowTime() function to show time set<br />    <br />    eSIG_BUTTON cursor;<br />    // set Secund to zero<br />    tmp-&gt;sSH = 0;<br />    tmp-&gt;sSL = 0;<br />    <br />    ShowTime(choisetime);<br />    uint8_t position;<br />    position = addr_Hours + 1;<br />    <br />    for (;;)<br />    {<br />        <br />        LCD_D = position;    <br />        Enab();<br />    <br />        __delay_ms(100);        <br />        cursor = Input_B();<br />        switch(cursor)<br />        {<br />            case LEFT:<br />                cursor = EMPTY;<br />                return;<br />                                <br />            case DOWN:<br />                // Free button<br />                cursor = EMPTY;<br />                break;<br />            case RIGHT:<br />                cursor = EMPTY;<br />                if (position == (addr_Minuts + 1))<br />                {<br />                    position = addr_Hours + 1;<br />                }<br />                else if (position == (addr_Hours + 1))<br />                {<br />                    position = addr_Minuts + 1;<br />                }<br />                LCD_D = position;    <br />                Enab();<br />                break;<br />            case UP:<br />                cursor = EMPTY;<br />                /* Change time value begin from hours<br />                 * <br />                 */<br />                if(position == (addr_Hours + 1))<br />                {<br />                    tmp-&gt;sHL++;<br />                    <br />                    if (tmp-&gt;sHL &gt; 4)<br />                    {<br />                        if (tmp-&gt;sHH == 2)<br />                            {<br />                                tmp-&gt;sHH = 0;<br />                                tmp-&gt;sHL = 0;<br />                            }<br />                        if (tmp-&gt;sHL &gt; 9)<br />                        {<br />                            tmp-&gt;sHH++;<br />                            tmp-&gt;sHL = 0;                                                      <br />                        }                        <br />                    }<br />                    <br />                    ShowTime(choisetime);<br />                }<br />                if ((position == addr_Minuts) || (position == addr_Minuts + 1))<br />                {<br />                    tmp-&gt;sML++;<br />                    <br />                    if (tmp-&gt;sML &gt; 9)<br />                    {<br />                        if (tmp-&gt;sMH == 5)<br />                        {<br />                            tmp-&gt;sMH = 0;<br />                            tmp-&gt;sML = 0;<br />                        }<br />                        else {<br />                            tmp-&gt;sML = 0;<br />                            tmp-&gt;sMH++;<br />                        }<br />                    }                    <br />                    // Show update time<br />                    ShowTime(choisetime);<br />                }<br />                break;<br />            case EMPTY:<br />                // Nothing TODO<br />                break;<br />        }<br />        <br />    }// end for<br />}</code></p>
<p><code>void ON()<br />{<br />    // Function write text on second line<br />    LCD_D = 0xC0;           // Line 2<br />    Enab();<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x5A);<br />    Write_LCD(0x61);<br />    Write_LCD(0x70);<br />    Write_LCD(0x6E);<br />    Write_LCD(0x75);<br />    Write_LCD(0x74);<br />    Write_LCD(0x6F);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    <br />}</code></p>
<p><code>void OFF()<br />{<br />    // Function write text on second line<br />    LCD_D = 0xC0;           // Line 2<br />    Enab();<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x56);<br />    Write_LCD(0x79);<br />    Write_LCD(0x70);<br />    Write_LCD(0x6E);<br />    Write_LCD(0x75);<br />    Write_LCD(0x74);<br />    Write_LCD(0x6F);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    Write_LCD(0x20);<br />    <br />}</code></p>